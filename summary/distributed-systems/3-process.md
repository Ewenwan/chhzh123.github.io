---
layout: post
title: 分布式系统（3）-进程
date: 2019-08-29
tag: [summary]
---

上下文：系统运行过程中的一系列状态，状态的含义因系统的不同而不同
* 处理器上下文
	- 处理器用于运行一系列指令的保存在寄存器中的最小数据集合（如：栈指针、地址寄存器、程序计数器）
* 线程上下文
	- 用于执行一系列指令的保存在寄存器和内存中的最小的数据集合（如：处理器上下文、状态等）
* 进程上下文
	- 用于执行线程的保存在寄存器和内存中的最小的数据集合（线程上下文、MMU寄存器值、TLB）

线程切换特性
* 线程共享相同的地址空间（但也更容易出错），线程上下文的切换可以独立于操作系统
* 一般来讲进程之间的切换要更复杂、代价更高，因为需要陷入到O内核才能完成
* 创建和销毁线程的代价要远远小于对进程的创建和销毁

线程实现方式：
* 线程包形式
* 完全在用户空间下创建线程库
* 由内核掌管线程并进行调度
* 好处：上下文切换代价小
* 缺陷：线程阻塞->进程阻塞
* 应用：
	- 多线程web客户端隐藏网络延迟
	- 服务期间多个请求-响应调用
	- 服务器高IO需求，多线程防止阻塞

虚拟化（软硬件多路复用）：模拟接口
* 硬件比软件变化得快
* 需要灵活的可移植性和代码迁移
* 失效和攻击隔离

虚拟化不同方式：
* 进程虚拟机(Process VM)：分离的指令集合，实际上是运行在操作系统之上的解释器(JVM)或模拟器(Qemu)
* 原生虚拟机监控器(Native VMM)：底层指令，同时具有跑在硬件上的最小操作系统
* 主机虚拟机监控器(Hosted VMM)：底层指令，需要一个完整的OS

代码迁移模型：code + exec + resource
* Client-Server (CS)：全部迁移到服务器端
* Remote Evaluation (REV)：将exec和resource迁移到服务器端
* Code on Demand (CoD)：将服务器上的代码迁移到客户端
* Mobile Agents (MA)：将code和exec迁移到服务器端

移动性
* 弱移动性：仅仅移动代码和数据片段（重启执行）
* 强移动性：移动组件，包括执行状态
	- 迁移(migration)：将整个对象从一台机器移动到另一台机器
	- 克隆(cloning)：将其设置为相同执行状态

	