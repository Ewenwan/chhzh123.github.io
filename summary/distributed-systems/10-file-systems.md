---
layout: post
title: 分布式系统（10） - 分布式文件系统
date: 2019-12-16
tag: [summary]
---

通常都是client-server的体系结构，典型代表是NFS(Network File System)
* 底层模型是远程文件访问模型
	- 远程访问模型：客户请求访问远程文件，直接在服务器端修改文件
	- 上载/下载模型：客户先将文件下载下来，本地修改后再上传

基于集群的分布式文件系统，传统client-server架构就不适用了
1. 加速文件访问速度，应用文件分片划分技术使文件可以并行访问，可以在**同一台**机器上将文件切分为多块
2. 将文件划分为较大数据块（如每块64MB），然后将数据块分布、复制到多个物理机器上(Amazon、Google)
	* master在内存中维护了一张(文件名，块服务器)的映射表，以日志形式保存对数据的更新操作，当日志过大时将创建检查点，存储主存数据
	* 大量实际工作通过chunk服务器完成，避免master成为瓶颈

文件系统中的进程：
* 无状态NFS：实现简单，服务器崩溃后不需要恢复；无法访问文件
* 有状态NFS：可以记录各个用户的访问状态（当前目录等等）；需要服务器维护关于客户端的大量信息

通常底层都是用RPC实现，传统的每做一次操作都要建一次RPC，后来的则将多次操作合并到一次RPC中，可能会导致很难恢复